<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>bLE-Oyster: firmware/main/ble.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">bLE-Oyster<span id="projectnumber">&#160;0.1</span>
   </div>
   <div id="projectbrief">Bluetooth Low Energy (bLE) oyster temperature and movement sensor.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('ble_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">ble.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="ble_8h_source.html">ble.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ble.cpp:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ble_8cpp__incl.svg" width="306" height="187"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7fd0fe705c9e986586f7b5c26e8641c2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ble_8cpp.html#a7fd0fe705c9e986586f7b5c26e8641c2">Bluetooth_Init</a> ()</td></tr>
<tr class="separator:a7fd0fe705c9e986586f7b5c26e8641c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3316be537af9ba88eac0503af4b45cbf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ble_8cpp.html#a3316be537af9ba88eac0503af4b45cbf">Bluetooth_StartAdvertising</a> ()</td></tr>
<tr class="separator:a3316be537af9ba88eac0503af4b45cbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac51c3eb1d2037d1bf4e5446f94465e9e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ble_8cpp.html#ac51c3eb1d2037d1bf4e5446f94465e9e">Bluetooth_ConnectCallback</a> (uint16_t conn_handle)</td></tr>
<tr class="separator:ac51c3eb1d2037d1bf4e5446f94465e9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a976701eee8aaef24470801def5bbde3c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ble_8cpp.html#a976701eee8aaef24470801def5bbde3c">Bluetooth_DisconnectCallback</a> (uint16_t conn_handle, uint8_t reason)</td></tr>
<tr class="separator:a976701eee8aaef24470801def5bbde3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a847522fea9ba2804d2047448a82aa11e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ble_8cpp.html#a847522fea9ba2804d2047448a82aa11e">Bluetooth_RxCallback</a> (uint16_t conn_handle)</td></tr>
<tr class="separator:a847522fea9ba2804d2047448a82aa11e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a9c36e58e7cf416f2523d2efa8eaacc83"><td class="memItemLeft" align="right" valign="top">BLEDfu&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ble_8cpp.html#a9c36e58e7cf416f2523d2efa8eaacc83">bledfu</a></td></tr>
<tr class="memdesc:a9c36e58e7cf416f2523d2efa8eaacc83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Over the air updates.  <a href="ble_8cpp.html#a9c36e58e7cf416f2523d2efa8eaacc83">More...</a><br /></td></tr>
<tr class="separator:a9c36e58e7cf416f2523d2efa8eaacc83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55c3cae0ee06940349d88365ef3f46c3"><td class="memItemLeft" align="right" valign="top">BLEUart&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ble_8cpp.html#a55c3cae0ee06940349d88365ef3f46c3">bleuart</a></td></tr>
<tr class="memdesc:a55c3cae0ee06940349d88365ef3f46c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bluetooth UART.  <a href="ble_8cpp.html#a55c3cae0ee06940349d88365ef3f46c3">More...</a><br /></td></tr>
<tr class="separator:a55c3cae0ee06940349d88365ef3f46c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3df856729b3af3070dfca595f9accd4"><td class="memItemLeft" align="right" valign="top">BLEDis&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ble_8cpp.html#ab3df856729b3af3070dfca595f9accd4">bledis</a></td></tr>
<tr class="memdesc:ab3df856729b3af3070dfca595f9accd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Device information.  <a href="ble_8cpp.html#ab3df856729b3af3070dfca595f9accd4">More...</a><br /></td></tr>
<tr class="separator:ab3df856729b3af3070dfca595f9accd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af29527d634dcee290fa1ef384d2dadf9"><td class="memItemLeft" align="right" valign="top">BLEBas&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ble_8cpp.html#af29527d634dcee290fa1ef384d2dadf9">blebas</a></td></tr>
<tr class="memdesc:af29527d634dcee290fa1ef384d2dadf9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Device battery status.  <a href="ble_8cpp.html#af29527d634dcee290fa1ef384d2dadf9">More...</a><br /></td></tr>
<tr class="separator:af29527d634dcee290fa1ef384d2dadf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61e499ab5954656afdc350d620dda8e7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_bluetooth___type_def.html">Bluetooth_TypeDef</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ble_8cpp.html#a61e499ab5954656afdc350d620dda8e7">bt</a></td></tr>
<tr class="separator:a61e499ab5954656afdc350d620dda8e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ac51c3eb1d2037d1bf4e5446f94465e9e" name="ac51c3eb1d2037d1bf4e5446f94465e9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac51c3eb1d2037d1bf4e5446f94465e9e">&#9670;&nbsp;</a></span>Bluetooth_ConnectCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Bluetooth_ConnectCallback </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>conn_handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Callback event to handle connections over bluetooth.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conn_handle</td><td>Bluetooth connection handler. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a976701eee8aaef24470801def5bbde3c" name="a976701eee8aaef24470801def5bbde3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a976701eee8aaef24470801def5bbde3c">&#9670;&nbsp;</a></span>Bluetooth_DisconnectCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Bluetooth_DisconnectCallback </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>conn_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>reason</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Callback event to handle bluetooth disconnections.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conn_handle</td><td>Bluetooth connection handler. </td></tr>
    <tr><td class="paramname">reason</td><td>Represents disconnection type. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7fd0fe705c9e986586f7b5c26e8641c2" name="a7fd0fe705c9e986586f7b5c26e8641c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fd0fe705c9e986586f7b5c26e8641c2">&#9670;&nbsp;</a></span>Bluetooth_Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Bluetooth_Init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Initialise bluetooth communicaitons.</p>
<p >Setup over the air (OTA) firmware updates, bluetooth UART, device information (name, manufactuer etc.) and battery status. Also adjustable here is the TX communications power and the max number for concurrent bluetooth connections. </p>

</div>
</div>
<a id="a847522fea9ba2804d2047448a82aa11e" name="a847522fea9ba2804d2047448a82aa11e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a847522fea9ba2804d2047448a82aa11e">&#9670;&nbsp;</a></span>Bluetooth_RxCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Bluetooth_RxCallback </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>conn_handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Callback event for handling messages from bluetooth devices.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">central_uart</td><td>BLE UART client handler. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3316be537af9ba88eac0503af4b45cbf" name="a3316be537af9ba88eac0503af4b45cbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3316be537af9ba88eac0503af4b45cbf">&#9670;&nbsp;</a></span>Bluetooth_StartAdvertising()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Bluetooth_StartAdvertising </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Start advertising bluetooth connection for external devices to connect to. </p>
<p >&lt; Include name in packet</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="af29527d634dcee290fa1ef384d2dadf9" name="af29527d634dcee290fa1ef384d2dadf9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af29527d634dcee290fa1ef384d2dadf9">&#9670;&nbsp;</a></span>blebas</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BLEBas blebas</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Device battery status. </p>

</div>
</div>
<a id="a9c36e58e7cf416f2523d2efa8eaacc83" name="a9c36e58e7cf416f2523d2efa8eaacc83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c36e58e7cf416f2523d2efa8eaacc83">&#9670;&nbsp;</a></span>bledfu</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BLEDfu bledfu</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Over the air updates. </p>

</div>
</div>
<a id="ab3df856729b3af3070dfca595f9accd4" name="ab3df856729b3af3070dfca595f9accd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3df856729b3af3070dfca595f9accd4">&#9670;&nbsp;</a></span>bledis</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BLEDis bledis</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Device information. </p>

</div>
</div>
<a id="a55c3cae0ee06940349d88365ef3f46c3" name="a55c3cae0ee06940349d88365ef3f46c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55c3cae0ee06940349d88365ef3f46c3">&#9670;&nbsp;</a></span>bleuart</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BLEUart bleuart</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Bluetooth UART. </p>

</div>
</div>
<a id="a61e499ab5954656afdc350d620dda8e7" name="a61e499ab5954656afdc350d620dda8e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61e499ab5954656afdc350d620dda8e7">&#9670;&nbsp;</a></span>bt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_bluetooth___type_def.html">Bluetooth_TypeDef</a> bt</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .service = &amp;<a class="code hl_variable" href="ble_8cpp.html#a9c36e58e7cf416f2523d2efa8eaacc83">bledfu</a>,</div>
<div class="line">    .uart = &amp;<a class="code hl_variable" href="ble_8cpp.html#a55c3cae0ee06940349d88365ef3f46c3">bleuart</a>,</div>
<div class="line">    .device_info = &amp;<a class="code hl_variable" href="ble_8cpp.html#ab3df856729b3af3070dfca595f9accd4">bledis</a>,</div>
<div class="line">    .battery_status = &amp;<a class="code hl_variable" href="ble_8cpp.html#af29527d634dcee290fa1ef384d2dadf9">blebas</a>,</div>
<div class="line">    .num_connections = 1,</div>
<div class="line">    .tx_power = 4, </div>
<div class="line">    .connection_timeout = 120, </div>
<div class="line">}</div>
<div class="ttc" id="able_8cpp_html_a55c3cae0ee06940349d88365ef3f46c3"><div class="ttname"><a href="ble_8cpp.html#a55c3cae0ee06940349d88365ef3f46c3">bleuart</a></div><div class="ttdeci">BLEUart bleuart</div><div class="ttdoc">Bluetooth UART.</div><div class="ttdef"><b>Definition:</b> ble.cpp:4</div></div>
<div class="ttc" id="able_8cpp_html_a9c36e58e7cf416f2523d2efa8eaacc83"><div class="ttname"><a href="ble_8cpp.html#a9c36e58e7cf416f2523d2efa8eaacc83">bledfu</a></div><div class="ttdeci">BLEDfu bledfu</div><div class="ttdoc">Over the air updates.</div><div class="ttdef"><b>Definition:</b> ble.cpp:3</div></div>
<div class="ttc" id="able_8cpp_html_ab3df856729b3af3070dfca595f9accd4"><div class="ttname"><a href="ble_8cpp.html#ab3df856729b3af3070dfca595f9accd4">bledis</a></div><div class="ttdeci">BLEDis bledis</div><div class="ttdoc">Device information.</div><div class="ttdef"><b>Definition:</b> ble.cpp:5</div></div>
<div class="ttc" id="able_8cpp_html_af29527d634dcee290fa1ef384d2dadf9"><div class="ttname"><a href="ble_8cpp.html#af29527d634dcee290fa1ef384d2dadf9">blebas</a></div><div class="ttdeci">BLEBas blebas</div><div class="ttdoc">Device battery status.</div><div class="ttdef"><b>Definition:</b> ble.cpp:6</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d9edf6c004b4a7ff14fe9ae7a92214ee.html">firmware</a></li><li class="navelem"><a class="el" href="dir_43532460448d97320a2d8d3edbe18c15.html">main</a></li><li class="navelem"><a class="el" href="ble_8cpp.html">ble.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
</body>
</html>
